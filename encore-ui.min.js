/*
 * EncoreUI
 * https://github.com/rackerlabs/encore-ui

 * Version: 0.3.3 - 2014-03-21
 * License: Apache License, Version 2.0
 */

angular.module("encore.ui",["encore.ui.configs","encore.ui.rxActiveUrl","encore.ui.rxAge","encore.ui.rxBreadcrumbs","encore.ui.rxButton","encore.ui.rxCapitalize","encore.ui.rxDiskSize","encore.ui.rxDropdown","encore.ui.rxForm","encore.ui.rxIdentity","encore.ui.rxLocalStorage","encore.ui.rxLogout","encore.ui.rxModalAction","encore.ui.rxNav","encore.ui.rxNotify","encore.ui.rxPageTitle","encore.ui.rxPaginate","encore.ui.rxRelatedMenu","encore.ui.rxProductResources","encore.ui.rxSessionStorage","encore.ui.rxSortableColumn","encore.ui.rxSpinner"]),angular.module("encore.ui.configs",[]).constant("ROUTE_PATHS",{login:"/login"}).value("devicePaths",[{value:"/dev/xvdb",label:"/dev/xvdb"},{value:"/dev/xvdd",label:"/dev/xvdd"},{value:"/dev/xvde",label:"/dev/xvde"},{value:"/dev/xvdf",label:"/dev/xvdf"},{value:"/dev/xvdg",label:"/dev/xvdg"},{value:"/dev/xvdh",label:"/dev/xvdh"},{value:"/dev/xvdj",label:"/dev/xvdj"},{value:"/dev/xvdk",label:"/dev/xvdk"},{value:"/dev/xvdl",label:"/dev/xvdl"},{value:"/dev/xvdm",label:"/dev/xvdm"},{value:"/dev/xvdn",label:"/dev/xvdn"},{value:"/dev/xvdo",label:"/dev/xvdo"},{value:"/dev/xvdp",label:"/dev/xvdp"}]),angular.module("encore.ui.rxActiveUrl",[]).directive("rxActiveUrl",["$location",function(a){return{restrict:"E",templateUrl:"templates/rxActiveUrl.html",transclude:!0,replace:!0,scope:{url:"@"},controller:["$scope",function(b){b.isNavActive=function(b){return-1!==a.path().indexOf(b)}}],link:function(a,b,c){a.navActive=a.isNavActive(c.url)}}}]),angular.module("encore.ui.rxAge",[]).filter("rxAge",function(){return function(a,b){if(!a)return"Unavailable";if("z"===a)return"--";var c=moment(),d=moment(a),e=c.diff(d),f=moment.duration(e),g=parseInt(f.asDays(),10),h=parseInt(f.asHours(),10),i=parseInt(f.asMinutes(),10),j=[];return _.isNumber(b)||(b=2),g>0&&j.push({value:g,suffix:"d"}),h>0&&j.push({value:h-24*g,suffix:"h"}),j.push({value:i-60*h,suffix:"m"}),_.map(j.slice(0,b),function(a,b,c){return b==c.length-1?Math.round(a.value)+a.suffix:Math.floor(a.value)+a.suffix}).join(" ")}}),angular.module("encore.ui.rxBreadcrumbs",[]).factory("rxBreadcrumbsSvc",function(){var a=[{path:"",name:"Home"}],b={};return b.set=function(b){a=a.splice(0,1),a=a.concat(b)},b.getAll=function(){return a.slice(0)},b}).directive("rxBreadcrumbs",function(){return{restrict:"E",templateUrl:"templates/rxBreadcrumbs.html",controller:["$scope","rxBreadcrumbsSvc",function(a,b){a.breadcrumbs=b}],scope:{visible:"&"}}}),angular.module("encore.ui.rxButton",[]).directive("rxButton",function(){return{templateUrl:"templates/rxButton.html",restrict:"E",scope:{toggleMsg:"@",defaultMsg:"@",toggle:"="}}}),angular.module("encore.ui.rxCapitalize",[]).filter("rxCapitalize",function(){return function(a){return a.charAt(0).toUpperCase()+a.slice(1)}}),angular.module("encore.ui.rxDiskSize",[]).filter("rxDiskSize",function(){return function(a){var b=["GB","TB","PB"],c=Math.floor(Math.log(a)/Math.log(1e3));return a/Math.pow(1e3,Math.floor(c)).toFixed(1)+" "+b[c]}}),angular.module("encore.ui.rxDropdown",[]).directive("rxDropdown",["$rootScope",function(a){return{restrict:"E",templateUrl:"templates/rxDropdown.html",link:function(b,c){b.visible=!1,b.toggle=function(d){d.preventDefault(),b.visible=!b.visible,a.$broadcast("dropdownShow",c)},b.$on("dropdownShow",function(a,d){d[0]!==c[0]&&(b.visible=!1)})},scope:{visible:"&",menu:"="}}}]),angular.module("encore.ui.rxForm",["ngSanitize"]).directive("rxFormItem",function(){return{restrict:"E",templateUrl:"templates/rxFormItem.html",transclude:!0,scope:{label:"@",suffix:"@",prefix:"@",description:"@"}}}).directive("rxFormInput",function(){return{restrict:"E",templateUrl:"templates/rxFormInput.html",scope:{type:"@",required:"@",fieldId:"@",model:"=",minLength:"@",maxLength:"@",max:"@",min:"@",name:"@",value:"@",label:"@",suffix:"@",description:"@"}}}).directive("rxFormRadio",function(){return{restrict:"E",templateUrl:"templates/rxFormRadio.html",scope:{options:"=",fieldId:"@",model:"="}}}).directive("rxFormSelect",function(){return{restrict:"E",templateUrl:"templates/rxFormSelect.html",scope:{options:"=",fieldId:"@",label:"@",model:"=",required:"@"}}}).directive("rxFormOptionTable",function(){return{restrict:"E",templateUrl:"templates/rxFormOptionTable.html",scope:{data:"=",columns:"=",selected:"@",type:"@",model:"=",fieldId:"@"}}}),angular.module("encore.ui.rxIdentity",["ngResource"]).factory("Identity",["$resource",function(a){var b=a("/identity/:action",{},{loginWithJSON:{method:"POST",isArray:!1,params:{action:"tokens"}},validate:{method:"GET",url:"/identity/login/session/:id",isArray:!1}});return b.login=function(a,c,d){var e={auth:{passwordCredentials:{username:a.username,password:a.password}}};return b.loginWithJSON(e,c,d)},b}]),angular.module("encore.ui.rxLocalStorage",[]).service("LocalStorage",["$window",function(a){this.setItem=function(b,c){a.localStorage.setItem(b,c)},this.getItem=function(b){return a.localStorage.getItem(b)},this.key=function(b){return a.localStorage.key(b)},this.removeItem=function(b){a.localStorage.removeItem(b)},this.clear=function(){a.localStorage.clear()},this.__defineGetter__("length",function(){return a.localStorage.length}),this.setObject=function(a,b){var c=_.isObject(b)||_.isArray(b)?JSON.stringify(b):b;this.setItem(a,c)},this.getObject=function(b){var c=a.localStorage.getItem(b);try{c=JSON.parse(c)}catch(d){return c}return c}}]),angular.module("encore.ui.rxLogout",[]).directive("rxLogout",["$rootScope","Auth",function(a,b){return{restrict:"A",controller:["$scope",function(c){var d=function(){a.$broadcast("event:auth-loginRequired")};c.logout=function(){b.logout(d)}}],link:function(a,b){var c=function(b){b&&b.preventDefault&&b.preventDefault(),a.logout()};b.bind("click",c)}}}]),angular.module("encore.ui.rxModalAction",["ui.bootstrap"]).directive("rxModalForm",function(){return{transclude:!0,templateUrl:"templates/rxModalActionForm.html",restrict:"E",scope:{title:"@",subtitle:"@",isLoading:"=",submitText:"@",cancelText:"@"}}}).controller("rxModalCtrl",["$scope","$modalInstance",function(a,b){a.submit=function(){b.close(a)},a.cancel=b.dismiss}]).directive("rxModalAction",["$modal",function(a){var b=function(b,c){var d=a.open({templateUrl:b.templateUrl,controller:"rxModalCtrl",scope:c});return d};return{transclude:!0,templateUrl:"templates/rxModalAction.html",restrict:"E",scope:!0,link:function(a,c,d){a.classes=d.classes;var e=function(){c.find("a")[0].focus()},f=function(){e(),a.$eval(d.postHook),a.fields={}};a.showModal=function(c){c.preventDefault(),a.fields=a.fields||{},a.$eval(d.preHook);var g=b(d,a);g.result.then(f,e)}}}}]),angular.module("encore.ui.rxNav",["encore.ui.rxDropdown"]).directive("rxNav",function(){return{templateUrl:"templates/rxNav.html",restrict:"E",scope:{searchFunction:"&",placeholderText:"@",links:"=?",logo:"=?"},controller:["$scope",function(a){a.bookmarks={linkText:"Bookmarks",items:[{title:"Bookmarks go here!",path:"/"}]},a.dashboards={linkText:"Dashboards",items:[{title:"Link 1",path:"/path"},{title:"Link 2",path:"/path2"},{title:"Link 3",path:"/path3"}]},a.internalTools={linkText:"Internal Tools",items:[{title:"Ticket Queues",path:"/#/ticketqueues/",className:""}]}}]}}),angular.module("encore.ui.rxNotify",["ngSanitize"]).directive("rxNotifications",["rxNotify",function(a){return{scope:{stack:"@?"},restrict:"E",replace:!0,templateUrl:"templates/rxNotifications.html",controller:["$scope",function(b){b.dismiss=function(b){a.dismiss(b)}}],link:function(b){var c=b.stack||"page";b.$watch(function(){return a.stacks[c]},function(a){b.messages=a}),b.loading=!0}}}]).factory("rxNotify",["$timeout","$rootScope",function(a,b){var c="page",d={};d[c]=[];var e=[],f={type:"info",timeout:-1,dismissable:!0,loading:!1,show:"immediate",dismiss:"next",stack:"page"},g=function(a){a.timeout>-1&&h(a),a.text.length>0&&d[a.stack].push(a)},h=function(b){var c=1e3*b.timeout;a(function(){m(b)},c)},i=function(a,b){var c,d=a[b][0],e=a[b][1];"show"==b?c=g:"dismiss"==b&&(c=m,d.$on("$destroy",function(){m(a)})),d.$watch(e,function(b){b===!0&&c(a)})},j=function(){_.forOwn(d,function(a,b){d[b]=_.reject(d[b],{dismiss:f.dismiss})})},k=function(){_.each(e,function(a){g(a)}),e.length=0},l=function(a){d[a].length=0},m=function(a){d[a.stack]=_.reject(d[a.stack],{id:a.id})},n=function(a,b){var h={text:a};b=b||{},b.id=_.uniqueId();var j=b.stack||c;return _.isArray(d[j])||(d[j]=[]),_.defaults(b,f),_.merge(h,b),_.isArray(h.dismiss)&&i(h,"dismiss"),h.show==f.show?g(h):"next"==h.show?e.push(h):_.isArray(h.show)&&i(h,"show"),h};return b.$on("$routeChangeSuccess",function(){j(),k()}),{add:n,clear:l,dismiss:m,stacks:d}}]).factory("rxPromiseNotifications",["rxNotify","$rootScope","$q","$interpolate",function(a,b,c,d){var e=b.$new(),f=function(){a.dismiss(this.loadingMsg)},g=function(b,c){if(b in this.msgs&&!this.isCancelled){var e=d(this.msgs[b]),f=e(c),g={type:b};this.stack&&(g.stack=this.stack),a.add(f,g)}},h=function(){this.isCancelled=!0,this.deferred.reject()},i=function(d,i,j){var k=c.defer(),l=_.uniqueId("promise_");e[l]={isCancelled:!1,msgs:i,stack:j};var m={loading:!0};return j&&(m.stack=j),e[l].loadingMsg=a.add(i.loading,m),k.promise.then(g.bind(e[l],"success"),g.bind(e[l],"error")).finally(f.bind(e[l])),d.then(function(a){k.resolve(a)},function(a){k.reject(a)}),b.$on("$routeChangeStart",h.bind(e[l])),e[l].deferred=k,e[l]};return{add:i}}]),angular.module("encore.ui.rxPageTitle",[]).factory("rxPageTitle",["$document",function(a){var b="",c="";return{setSuffix:function(a){b=a},getSuffix:function(){return b},setTitle:function(d){c=""!==b?d+b:d,a.prop("title",c)},getTitle:function(){return a.prop("title")}}}]),angular.module("encore.ui.rxPaginate",[]).directive("rxPaginate",function(){return{templateUrl:"templates/rxPaginate.html",replace:!0,restrict:"E",scope:{pageTracking:"=",numberOfPages:"@"}}}).factory("PageTracking",function(){function a(a){this.settings=_.defaults(a,{itemsPerPage:10,pagesToShow:5,pageNumber:0,pageInit:!1,total:0,showAll:!1})}return{createInstance:function(b){b=b?b:{};var c=new a(b);return c.settings}}}).filter("Paginate",["PageTracking",function(a){return function(b,c){if(c||(c=a.createInstance()),c.showAll)return c.total=b.length,b;if(b){c.total=b.length,c.totalPages=Math.ceil(c.total/c.itemsPerPage);var d=c.pageNumber*c.itemsPerPage,e=d+c.itemsPerPage,f=e>b.length?b.length:e;return c.first=d+1,c.last=f,b.slice(d,f)}}}]).filter("Page",["PageTracking",function(a){return function(b){b||(b=a.createInstance());var c=[],d=b.pagesToShow||5,e=(d-1)/2,f=Math.ceil(e),g=Math.floor(e);if(b&&0!==b.length){var h=Math.max(Math.min(b.pageNumber-g,b.totalPages-d),0),i=Math.min(Math.max(b.pageNumber+f,d-1),b.totalPages-1);for(h;i>=h;h++)c.push(h)}return c}}]),angular.module("encore.ui.rxRelatedMenu",[]).directive("rxRelatedMenu",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"templates/rxRelatedMenu.html",scope:{collapsable:"&",defaultState:"@",trigger:"@",state:"=",position:"@"},link:function(a){a.menuPosition=_.isEmpty(a.position)?"left":a.position,a.state=_.isEmpty(a.defaultState)?"open":"open"==a.defaultState,a.isCollapsable=a.collapsable(),a.toggleRelatedMenu=function(){a.state=!a.state}}}}),angular.module("encore.ui.rxProductResources",["encore.ui.rxActiveUrl","encore.ui.rxRelatedMenu"]).directive("rxProductResources",function(){return{restrict:"E",templateUrl:"templates/rxProductResources.html",scope:{user:"="}}}),angular.module("encore.ui.rxSessionStorage",[]).service("SessionStorage",["$window",function(a){this.setItem=function(b,c){a.sessionStorage.setItem(b,c)},this.getItem=function(b){return a.sessionStorage.getItem(b)},this.key=function(b){return a.sessionStorage.key(b)},this.removeItem=function(b){a.sessionStorage.removeItem(b)},this.clear=function(){a.sessionStorage.clear()},this.__defineGetter__("length",function(){return a.sessionStorage.length}),this.setObject=function(a,b){var c=_.isObject(b)||_.isArray(b)?JSON.stringify(b):b;this.setItem(a,c)},this.getObject=function(b){var c=a.sessionStorage.getItem(b);try{c=JSON.parse(c)}catch(d){return c}return c}}]),angular.module("encore.ui.rxSortableColumn",[]).directive("rxSortableColumn",function(){return{restrict:"E",templateUrl:"templates/rxSortableColumn.html",transclude:!0,scope:{sortMethod:"=",sortProperty:"@",predicate:"=",reverse:"="}}}).factory("rxSortUtil",function(){var a={};return a.getDefault=function(a,b){var c=a?a:"name";return{predicate:c,reverse:b}},a.sortCol=function(a,b){var c=a.sort.predicate===b?!a.sort.reverse:!1;a.sort={reverse:c,predicate:b},a.pager&&(a.pager.pageNumber=0)},a}),angular.module("encore.ui.rxSpinner",[]).directive("rxSpinner",function(){return{restrict:"A",scope:{toggle:"=",size:"@"},link:function(a,b){a.$watch("toggle",function(c){var d=a.size?a.size:"";c?b.prepend('<div class="rx-spinner '+d+'"></div> '):b.find("div").remove()})}}});
//# sourceMappingURL=encore-ui-0.3.3.min.map